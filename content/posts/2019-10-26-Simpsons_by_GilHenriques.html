---
title: "Simpsons by Gil Henriques"
author: "Pablo"
date: 2019-10-26T21:14:14-05:00
categories: ["R"]
tags: ["R Markdown", "plot"]
output: 
    prettydoc::html_pretty:
    theme: architect
    highlight: github
---



<pre class="r"><code>library(tidyverse)
library(showtext) # for google fonts

font_add_google(&quot;Gaegu&quot;, &quot;gaegu&quot;)
showtext_auto()

# Read and prepare data ---------------------------------------------------

df &lt;- read_delim(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-08-27/simpsons-guests.csv&quot;, delim = &quot;|&quot;, quote = &quot;&quot;)
df2 &lt;- df %&gt;% mutate(number = strsplit(as.character(number), &quot;; &quot;)) %&gt;% 
  unnest() %&gt;% # Splits rows that contain multiple episodes into multiple rows
  group_by(season) %&gt;% summarize(guests_per_episode = n_distinct(guest_star)/n_distinct(number))


# Prepare for plot --------------------------------------------------------

# I want the axes and the line connecting the points to look hand-drawn, so I will use geom_line + jitter to draw them

spline_int &lt;- as.data.frame(spline(as.numeric(df2$season), df2$guests_per_episode, method = &quot;natural&quot;))
x.ax &lt;- data.frame(x = seq(from = 0, to = 30, by = 1), y = rep(0, 31))
y.ax &lt;- data.frame(x = rep(0, 21), y = seq(from = 0, to = 4, by = 0.2))


# Plotting ----------------------------------------------------------------

windows()

plot &lt;- df2 %&gt;% 
  ggplot(aes(x = as.numeric(season), y = guests_per_episode)) + 
  geom_point(size = 4, color = &quot;white&quot;) + 
  theme_void() + 
  theme(text = element_text(family = &quot;gaegu&quot;),
        axis.text = element_text(size = 15, color = &quot;white&quot;),
        axis.title = element_text(size = 20, color = &quot;white&quot;),
        plot.title = element_text(size = 25,face = &quot;bold&quot;, color = &quot;white&quot;, hjust = 0.5),
        plot.caption = element_text(color = &quot;white&quot;),
        plot.margin = margin(t = 1, r = 3, b = 1, l = 1, &quot;cm&quot;),
        axis.title.y = element_text(angle = 90)) + 
  ylab(&quot;Guests per episode&quot;) + xlab(&quot;Season&quot;) + 
  labs(title = &quot;The number of guest stars in\nthe Simpsons is increasing&quot;, caption = &quot;@_Gil_Henriques for #TidyTuesday&quot;) +
  ylim(-0.1,4.3) + xlim(-0.1, 30.5) + 
  geom_line(data = spline_int, aes(x = x, y = y), color = &quot;white&quot;, position = position_jitter(w = 0.05, h = 0.05), size = 0.8) +
  geom_line(data = x.ax, aes(x = x, y = y), color = &quot;white&quot;, position = position_jitter(w = 0.0, h = 0.05), size = 0.8) +
  geom_line(data = y.ax, aes(x = x, y = y), color = &quot;white&quot;, position = position_jitter(w = 0.05, h = 0.0), size = 0.8)

ggimage::ggbackground(plot, &quot;Images/chalkboard_simpsons.gif&quot;, by = &quot;height&quot;)</code></pre>
<p><img src="/posts/2019-10-26-Simpsons_by_GilHenriques_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
